# Change: 修复 TypeLayout 核心正确性和完备性问题

## Why

代码审计发现 TypeLayout 核心签名生成存在与文档规范不一致的问题，以及潜在的完备性缺陷。这些问题可能导致：
1. 签名无法正确区分不同内存布局的类型
2. 跨编译器签名比较不可靠

## What Changes

### 问题 1: Union 成员签名缺失 (Bug - 高优先级)

**现状**: `union[s:N,a:N]` - 无成员信息
**文档规范**: `union[s:N,a:N]{@0[i]:i32[s:4,a:4],@0[f]:f32[s:4,a:4]}`
**影响**: 具有相同大小/对齐但不同成员的 union 会生成相同签名

**修复**: 修改 `type_signature.hpp` 中的 union 分支，添加成员反射

### 问题 2: `[[no_unique_address]]` 属性 (C++20 完备性)

**现状**: 未检测/标识
**问题**: GCC/Clang 和 MSVC 对此属性处理不同，可能导致相同代码不同布局
**影响**: 潜在的跨编译器签名不匹配

**建议**: P2996 的 `is_nua()` 如果可用，在签名中标识。否则低优先级。

### 问题 3: 空基类优化 (EBO) 标识

**现状**: 未在签名中明确标识 EBO 是否生效
**问题**: 签名包含 size/alignment，应已捕获 EBO 效果
**评估**: **无需修复** - 因为签名中的 size 已反映 EBO 效果

### 问题 4: 成员指针类型大小差异

**现状**: `memptr[s:N,a:N]` 仅记录大小
**问题**: MSVC 的成员指针大小取决于继承模式
**评估**: **当前设计已覆盖** - 因为 N 会反映实际大小

## Impact

- 影响文件: `include/boost/typelayout/core/type_signature.hpp`
- 影响测试: `test/test_all_types.cpp` (需更新 union 断言)
- 文档: 当前文档规范正确，代码实现不一致

## 优先级

1. **必须修复**: Union 成员签名缺失 (与规范不一致)
2. **建议跟踪**: `[[no_unique_address]]` 属性 (P2996 依赖)
3. **无需修改**: EBO、成员指针 (当前设计已覆盖)
